{% import 'macros/_commodity_macros.html' as commodity_macros %}
{% set ledger = ledger or g.ledger %}

{% set arg_filter = request.args.get('account_filter') %}

<p>
  <label for="portfolio-list-filter">Custom Account Filter:</label>
  <input id="portfolio-list-filter" value={{ arg_filter or "" }}>
  <button id="portfolio-update-filter">Update Filter</button>
  <button id="portfolio-clear-filter">Clear Filter</button>
</p>

{% set portfolio = extension.portfolio(arg_filter) %}

{% if portfolio.error_message is defined %}
  <div class="error-message" style="color: hsl(0deg 100% 30%); border: 1px solid hsl(0deg 100% 30%); padding: 1em; margin: 1em 0; border-radius: 3px;">
    <strong>Error:</strong> {{ portfolio.error_message }}
  </div>
{% else %}
  <h3>Portfolio <small>(Total: {{ commodity_macros.render_num(ledger, portfolio.total.currency, portfolio.total.number) }})</small></h3>
  <svelte-component type="query-table"><script type="application/json">{{portfolio.table|tojson}}</script></svelte-component>
{% endif %}
